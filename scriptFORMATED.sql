--Biblioteca
--Script para creacion de tablas en la BD
--Por Gabriel,Bryan,Nelson y Leonardo
--Creado sábado,4 de marzo de 2018
--Universidad Centroamericana ISI

-- Tabla Ubicación
CREATE TABLE ubicacion (
    idubicacion    NUMBER(3)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_ubicacion PRIMARY KEY ( idubicacion ),
    pais           VARCHAR2(10) NOT NULL,
    ciudad         VARCHAR2(10),
    nacionalidad   VARCHAR2(15) NOT NULL
);

-- TABLA Bibliotecario

CREATE TABLE bibliotecario (
    idbibliotecario   NUMBER(3)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_bibliotecario PRIMARY KEY ( idbibliotecario ),
    nombre            VARCHAR2(20) NOT NULL,
    apellido          VARCHAR2(20) NOT NULL
);

-- Tabla Estado

CREATE TABLE estado (
    idestado   NUMBER(2)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_estado PRIMARY KEY ( idestado ),
    estado     VARCHAR2(20) NOT NULL
);

-- Tabla TipoDocumento

CREATE TABLE tipodocumento (
    idtipodocumento   NUMBER(2)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_tipodocumento PRIMARY KEY ( idtipodocumento ),
    nombre            VARCHAR2(30) NOT NULL
);

-- TABLA CategoriaGeneral

CREATE TABLE categoriageneral (
    codigogeneral   NUMBER(3) PRIMARY KEY,
    nombre          VARCHAR(50) NOT NULL
);

-- Tabla Usuario

CREATE TABLE usuario (
    idusuario        NUMBER(5)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_usuario PRIMARY KEY ( idusuario ),
    nombre           VARCHAR2(20) NOT NULL,
    apellido         VARCHAR2(20) NOT NULL,
    identificacion   VARCHAR2(20) NOT NULL,
    sexo             VARCHAR2(10),
    idubicacion      NUMBER(3) NOT NULL
        CONSTRAINT fk_usuario_ubicacion
            REFERENCES ubicacion ( idubicacion )
);

-- TABLA Autor

CREATE TABLE autor (
    idautor           NUMBER(5)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_autor PRIMARY KEY ( idautor ),
    nombre            VARCHAR2(20) NOT NULL,
    apellido          VARCHAR2(20) NOT NULL,
    sexo              VARCHAR2(10),
    idubicacion       NUMBER(3) NOT NULL
        CONSTRAINT fk_autor_ubicacion
            REFERENCES ubicacion ( idubicacion ),
    fechanacimiento   DATE NULL
);

-- TABLA CategoriaEspecial

CREATE TABLE categoriaespecial (
    codigoespecial   NUMBER(3) PRIMARY KEY,
    nombre           VARCHAR2(50) NOT NULL,
    codigogeneral    NUMBER(3) NOT NULL
        CONSTRAINT fk_catespecial_catgeneral
            REFERENCES categoriageneral ( codigogeneral )
);

-- Tabla Editorial

CREATE TABLE editorial (
    ideditorial   NUMBER(3)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_editorial PRIMARY KEY ( ideditorial ),
    nombre        VARCHAR(60) NOT NULL,
    idubicacion   NUMBER(3) NOT NULL
        CONSTRAINT fk_editorial_ubicacion
            REFERENCES ubicacion ( idubicacion )
);

-- TABLA LIBRO

CREATE TABLE libro (
    idlibro            NUMBER(7)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    isbn               VARCHAR2(25),
    CONSTRAINT pk_libro PRIMARY KEY ( idlibro,isbn ),
    depositolegal      VARCHAR2(20),
    titulo             VARCHAR2(100) NOT NULL,
    fechapublicacion   DATE NOT NULL,
    edicion            VARCHAR2(15),
    descripcion        VARCHAR2(300),
    paginas            NUMBER(4),
    numejemplares      NUMBER(2) NOT NULL,
    idubicacion        NUMBER(3) NOT NULL
        CONSTRAINT fk_ubicacion_libro
            REFERENCES ubicacion ( idubicacion ),
    idestado           NUMBER(2) NOT NULL
        CONSTRAINT fk_estado_libro
            REFERENCES estado ( idestado ),
    idtipodocumento    NUMBER(3) NOT NULL
        CONSTRAINT fk_tipodocumento_libro
            REFERENCES tipodocumento ( idtipodocumento ),
    codigo             NUMBER(3) NOT NULL
        CONSTRAINT fk_codigogeneral_libro
            REFERENCES categoriageneral ( codigogeneral ),
    codigoespecial     NUMBER(3) NOT NULL
        CONSTRAINT fk_codigoespecial_libro
            REFERENCES categoriaespecial ( codigoespecial )
);

-- TABLA PRESTAMO

CREATE TABLE prestamo (
    idprestamo        NUMBER(6)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_prestamo PRIMARY KEY ( idprestamo ),
    fechaprestamo     DATE NOT NULL,
    fechadevolucion   DATE NOT NULL,
    cantidad          NUMBER(2) NOT NULL,
    estado            VARCHAR2(20) NOT NULL,
    idusuario         NUMBER(4) NOT NULL
        CONSTRAINT fk_usuario_prestamo
            REFERENCES usuario ( idusuario ),
    idbibliotecario   NUMBER(4) NOT NULL
        CONSTRAINT fk_bibliotecario_prestamo
            REFERENCES bibliotecario ( idbibliotecario )
);

-- TABLA DETALLE LIBRO

CREATE TABLE detallelibro (
    iddetallelibro   NUMBER(6)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_detallelibro PRIMARY KEY ( iddetallelibro ),
    idlibro          NUMBER(6) NOT NULL,
    isbn             VARCHAR2(25) NOT NULL,
    CONSTRAINT fk_libro_detallelibro FOREIGN KEY ( idlibro,isbn )
        REFERENCES libro ( idlibro,isbn ),
    idautor          NUMBER(5) NOT NULL
        CONSTRAINT fk_autor_detallelibro
            REFERENCES autor ( idautor ),
    ideditorial      NUMBER(3) NOT NULL
        CONSTRAINT fk_editorial_detallelibro
            REFERENCES editorial ( ideditorial )
);

-- Tabla DetallePrestamo

CREATE TABLE detalleprestamo (
    iddetalleprestamo   NUMBER(6)
        GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CONSTRAINT pk_detalleprestamo PRIMARY KEY ( iddetalleprestamo ),
    idprestamo          NUMBER(6) NOT NULL
        CONSTRAINT fk_detalleprestamo_prestamo
            REFERENCES prestamo ( idprestamo ),
    idlibro             NUMBER(6) NOT NULL,
    isbn                VARCHAR2(25) NOT NULL,
    CONSTRAINT fk_libro_detalleprestamo FOREIGN KEY ( idlibro,isbn )
        REFERENCES libro ( idlibro,isbn )
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Nicaragua',
    'Managua',
    'Nicaraguense'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Mexico',
    'D.F.',
    'Mexicano'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Colombia',
    'Medellin',
    'Colombiano'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Venezuela',
    'Caracas',
    'Venezolano'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Alemania',
    'Berlin',
    'Alemania'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Espania',
    'Cadiz',
    'Espaniol'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Espania',
    'Madrid',
    'Espaniol'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Espania',
    'Barcelona',
    'Espaniol'
);

INSERT INTO ubicacion (
    pais,
    ciudad,
    nacionalidad
) VALUES (
    'Brasil',
    'Brasilia',
    'Brasilenio'
);

INSERT INTO usuario (
    nombre,
    apellido,
    identificacion,
    sexo,
    idubicacion
) VALUES (
    'Roberto',
    'Montano',
    '000017547',
    'Masculino',
    1
);

INSERT INTO usuario (
    nombre,
    apellido,
    identificacion,
    sexo,
    idubicacion
) VALUES (
    'Maria',
    'Lopez',
    '000056489',
    'Femenino',
    2
);

INSERT INTO usuario (
    nombre,
    apellido,
    identificacion,
    sexo,
    idubicacion
) VALUES (
    'Bryan',
    'Perez',
    '000023548',
    'Masculino',
    1
);

INSERT INTO usuario (
    nombre,
    apellido,
    identificacion,
    sexo,
    idubicacion
) VALUES (
    'Leonardo',
    'Cardoza',
    '000017562',
    'Masculino',
    4
);

INSERT INTO usuario (
    nombre,
    apellido,
    identificacion,
    sexo,
    idubicacion
) VALUES (
    'Nelson',
    'Cerros',
    '000078523',
    'Masculino',
    5
);

INSERT INTO tipodocumento ( nombre ) VALUES ( 'Libro' );

INSERT INTO tipodocumento ( nombre ) VALUES ( 'Tesis de Pregrado' );

INSERT INTO tipodocumento ( nombre ) VALUES ( 'Tesis de Posgrado' );

INSERT INTO tipodocumento ( nombre ) VALUES ( 'Publicaciones periodicas' );

INSERT INTO tipodocumento ( nombre ) VALUES ( 'Bibliografias' );

INSERT INTO estado ( estado ) VALUES ( 'EN EXISTENCIA' );

INSERT INTO estado ( estado ) VALUES ( 'EN PRESTAMO ED UNIC' );

INSERT INTO estado ( estado ) VALUES ( 'EN PRESTAMO' );

INSERT INTO estado ( estado ) VALUES ( 'BAJO CONSUMO' );

INSERT INTO estado ( estado ) VALUES ( 'AGOTADO' );

INSERT INTO editorial (
    nombre,
    idubicacion
) VALUES (
    'Monte Avila Latinoamericana,C.A.',
    4
);

INSERT INTO editorial (
    nombre,
    idubicacion
) VALUES (
    'HISPAMER',
    1
);

INSERT INTO editorial (
    nombre,
    idubicacion
) VALUES (
    'Libros McGraw-Hill de Mexico,S.A. de C.V.',
    2
);

INSERT INTO editorial (
    nombre,
    idubicacion
) VALUES (
    'Random House Mondadori,S.A. de C.V.',
    2
);

INSERT INTO editorial (
    nombre,
    idubicacion
) VALUES (
    'Publicaciones y Ediciones Salamandra,S.A.',
    9
);

INSERT INTO autor (
    nombre,
    apellido,
    sexo,
    idubicacion
) VALUES (
    'Antonio',
    'Pasquali',
    'Masculino',
    4
);

INSERT INTO autor (
    nombre,
    apellido,
    sexo,
    idubicacion
) VALUES (
    'Joaquim',
    'Rabella Vives',
    'Masculino',
    1
);

INSERT INTO autor (
    nombre,
    apellido,
    sexo,
    idubicacion
) VALUES (
    'Luis',
    'Joyanes Aguilar',
    'Masculino',
    7
);

INSERT INTO autor (
    nombre,
    apellido,
    sexo,
    idubicacion
) VALUES (
    'Paulo',
    'Coelho',
    'Masculino',
    8
);

INSERT INTO autor (
    nombre,
    apellido,
    sexo,
    idubicacion
) VALUES (
    'Antonio',
    'Pasquali',
    'Masculino',
    1
);

INSERT INTO bibliotecario (
    nombre,
    apellido
) VALUES (
    'Roberto',
    'Montano'
);

INSERT INTO bibliotecario (
    nombre,
    apellido
) VALUES (
    'Julian',
    'Romero'
);

INSERT INTO bibliotecario (
    nombre,
    apellido
) VALUES (
    'Alberto',
    'Reyes'
);

INSERT INTO bibliotecario (
    nombre,
    apellido
) VALUES (
    'Armando',
    'Casas'
);

INSERT INTO bibliotecario (
    nombre,
    apellido
) VALUES (
    'Carlos',
    'Lopez'
);

SET

DEFINE off;

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    000,
    'Generalidades'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    100,
    'Filosofía & Psicologia'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    200,
    'Religion'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    300,
    'Ciencias Sociales'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    400,
    'Lenguas'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    500,
    'Ciencias Naturales & Matematicas'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    600,
    'Tecnologia (Ciencias aplicadas)'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    700,
    'Las Artes'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    800,
    'Literatura & Retórica'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    900,
    'Geografia & Historia'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    010,
    'Bibliografia'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    110,
    'Metafisica'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    210,
    'Filosofia & teoria de la religion'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    310,
    'Colecs. de estadística general'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    410,
    'Linguistica'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    510,
    'Matematicas'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    610,
    'Ciencias Medicas Medicina'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    710,
    'Urbanismo & Arte del paisaje'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    860,
    'Literaturas española & portuguesa'
);

INSERT INTO categoriageneral (
    codigogeneral,
    nombre
) VALUES (
    970,
    'Historia General de América del Norte'
);

INSERT INTO categoriaespecial (
    codigoespecial,
    nombre,
    codigogeneral
) VALUES (
    418,
    'Uso estándar,Lingüística aplicada',
    410
);

INSERT INTO categoriaespecial (
    codigoespecial,
    nombre,
    codigogeneral
) VALUES (
    972,
    'Mesoamérica,México',
    970
);

INSERT INTO categoriaespecial (
    codigoespecial,
    nombre,
    codigogeneral
) VALUES (
    005,
    'Programación,programas,datos de computación',
    000
);

INSERT INTO categoriaespecial (
    codigoespecial,
    nombre,
    codigogeneral
) VALUES (
    863,
    'Ficción española',
    860
);

SET DEFINE ON;

INSERT INTO libro (
    isbn,
    titulo,
    fechapublicacion,
    edicion,
    descripcion,
    paginas,
    numejemplares,
    idubicacion,
    idestado,
    idtipodocumento,
    codigo,
    codigoespecial
) VALUES (
    '980-01-0024-5',
    'Comprender la comunicacion',
    TO_DATE('1990','YYYY'),
    '4ta edicion',
    'Libro sobre comunicacion',
    306,
    5,
    4,
    1,
    1,
    410,
    418
);

INSERT INTO libro (
    isbn,
    titulo,
    fechapublicacion,
    edicion,
    descripcion,
    paginas,
    numejemplares,
    idubicacion,
    idestado,
    idtipodocumento,
    codigo,
    codigoespecial
) VALUES (
    '978-99924-79-84-1',
    'Aproximacion a la historia de Rio San Juan',
    TO_DATE('2013','YYYY'),
    '3ra edicion',
    'Libro sobre la historia de Rio San Juan',
    190,
    1,
    1,
    2,
    1,
    900,
    972
);

INSERT INTO libro (
    isbn,
    depositolegal,
    titulo,
    fechapublicacion,
    descripcion,
    paginas,
    numejemplares,
    idubicacion,
    idestado,
    idtipodocumento,
    codigo,
    codigoespecial
) VALUES (
    '968-422-216-5',
    'M. 23.299-1990',
    'BASIC Avanzado Tratamiento y diseño de archivos',
    TO_DATE('1990','YYYY'),
    'Libro sobre BASIC',
    333,
    6,
    2,
    1,
    3,
    000,
    005
);

INSERT INTO libro (
    isbn,
    titulo,
    fechapublicacion,
    edicion,
    descripcion,
    paginas,
    numejemplares,
    idubicacion,
    idestado,
    idtipodocumento,
    codigo,
    codigoespecial
) VALUES (
    '978-970-810-304-6',
    'El Zahir',
    TO_DATE('2010','YYYY'),
    '4ta reimpresion',
    'Libro de literatura de Paulo Coelho',
    352,
    10,
    2,
    1,
    1,
    860,
    863
);

INSERT INTO libro (
    isbn,
    depositolegal,
    titulo,
    fechapublicacion,
    edicion,
    descripcion,
    paginas,
    numejemplares,
    idubicacion,
    idestado,
    idtipodocumento,
    codigo,
    codigoespecial
) VALUES (
    '84-7888-994-9',
    'B-51.244-2005',
    'Harry Potter y el misterio del principe',
    TO_DATE('2006','YYYY'),
    '1ra edicion',
    '6to libro en serie de Harry Potter',
    609,
    3,
    8,
    4,
    1,
    860,
    863
);

--Valores para préstamo

INSERT INTO prestamo (
    idusuario,
    idbibliotecario,
    fechaprestamo,
    fechadevolucion,
    cantidad,
    estado
) VALUES (
    1,
    1,
    TO_DATE('12/04/2017','DD/MM/YYYY'),
    TO_DATE('19/04/2017','DD/MM/YYYY'),
    1,
    'Prestamo Vigente'
);

INSERT INTO prestamo (
    idusuario,
    idbibliotecario,
    fechaprestamo,
    fechadevolucion,
    cantidad,
    estado
) VALUES (
    2,
    2,
    TO_DATE('18/07/2017','DD/MM/YYYY'),
    TO_DATE('23/07/2017','DD/MM/YYYY'),
    1,
    'Prestamo Vigente'
);

INSERT INTO prestamo (
    idusuario,
    idbibliotecario,
    fechaprestamo,
    fechadevolucion,
    cantidad,
    estado
) VALUES (
    3,
    3,
    TO_DATE('08/08/2017','DD/MM/YYYY'),
    TO_DATE('12/08/2017','DD/MM/YYYY'),
    2,
    'Prestamo Vencido'
);

INSERT INTO prestamo (
    idusuario,
    idbibliotecario,
    fechaprestamo,
    fechadevolucion,
    cantidad,
    estado
) VALUES (
    4,
    4,
    TO_DATE('21/08/2017','DD/MM/YYYY'),
    TO_DATE('25/08/2017','DD/MM/YYYY'),
    3,
    'Prestamo Vigente'
);

INSERT INTO prestamo (
    idusuario,
    idbibliotecario,
    fechaprestamo,
    fechadevolucion,
    cantidad,
    estado
) VALUES (
    5,
    1,
    TO_DATE('17/10/2017','DD/MM/YYYY'),
    TO_DATE('23/10/2017','DD/MM/YYYY'),
    1,
    'Prestamo Finalizado'
);

INSERT INTO detallelibro (
    idlibro,
    isbn,
    idautor,
    ideditorial
) VALUES (
    1,
    '980-01-0024-5',
    1,
    1
);

INSERT INTO detallelibro (
    idlibro,
    isbn,
    idautor,
    ideditorial
) VALUES (
    2,
    '978-99924-79-84-1',
    2,
    2
);

INSERT INTO detallelibro (
    idlibro,
    isbn,
    idautor,
    ideditorial
) VALUES (
    3,
    '968-422-216-5',
    3,
    3
);

INSERT INTO detallelibro (
    idlibro,
    isbn,
    idautor,
    ideditorial
) VALUES (
    4,
    '978-970-810-304-6',
    4,
    4
);

INSERT INTO detallelibro (
    idlibro,
    isbn,
    idautor,
    ideditorial
) VALUES (
    5,
    '84-7888-994-9',
    5,
    5
);

--Valores para detalle_préstamo

INSERT INTO detalleprestamo (
    idlibro,
    isbn,
    idprestamo
) VALUES (
    1,
    '980-01-0024-5',
    1
);

INSERT INTO detalleprestamo (
    idlibro,
    isbn,
    idprestamo
) VALUES (
    2,
    '978-99924-79-84-1',
    2
);

INSERT INTO detalleprestamo (
    idlibro,
    isbn,
    idprestamo
) VALUES (
    3,
    '968-422-216-5',
    3
);

INSERT INTO detalleprestamo (
    idlibro,
    isbn,
    idprestamo
) VALUES (
    4,
    '978-970-810-304-6',
    4
);

INSERT INTO detalleprestamo (
    idlibro,
    isbn,
    idprestamo
) VALUES (
    5,
    '84-7888-994-9',
    5
);
